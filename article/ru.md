# Как не надо разрабатывать телеграм бота

Сразу начну с разрушения канонов - я не задолбался. Я большой фанат ранних пробуждений и продуктивного утра. К сожалению, мой энтузиазм наиболее ярок после того как я просплю очередное утро: ну вот завтра я точно встану в 7! Поэтому я решил написать простого помощника, который будет присылать мне напоминания каждое утро и трекать мой прогресс.

![img.png](img.png)

Настройка **в один клик** (точнее инпут) - пользователь задает время пробуждения. В заданное время бот отправляет уведомление и сохраняет результат. Просто и ясно, что может пойти не так?

![img_1.png](img_1.png)

Первую подножку подставил телеграм - его апи не позволяет определить таймзону пользователя. А это значит, что я не знаю в какое время уведомить пользователя. Поэтому в инициализацию бота пришлось добавить еще один вопрос - сколько сейчас времени? Пользователь отвечает и я сохраняю разницу между его временем и UTC. Решение, конечно, не идеальное - в частности, я не знаю нужен ли пользователю перевод стрелок на летнее время, но рабочее.

![img_2.png](img_2.png)

Ну а дальше я совершил, наверное, самую распространенную ошибку ~~программиста~~ перфекциониста: я не смог остановиться. Начиналось все довольно невинно - я нашел стартер шаблон для бота который использует Typescript и фреймворк Grammy. Шаблон не предусматривал ничего для деплоймента, но не буду же я деплоить свой бот руками. Я начал с того, что подготовил Dockerfile, и закончил тем, что написал CI/CD систему которая деплоит бота в ноль кликов. Я просто пушу свой коммит в репозиторий, и система автоматически разворачивает новую версию бота.

Присмотревшись к шаблону (не могу же использовать код в котором я полностью не разобрался), я понял что он порядком устарел и не полностью использует возможности фреймворка grammy: не поддерживает сессии, плагин для интернализации... Во время рефакторинга я разобрался глубже с фреймворком, и понял что и мой собственный код не используют его на полную катушку...

В какой-то момент, я понял: бот мог быть уже давно готов. Парадоксально: разработка бота уперлась не в технические возможности, а в психологию. Дело бы не в знаниях, дело было в отсутствие внутреннего разрешения сделать неидеальную работу. В момент когда я его себе дал - бот был готов. 



